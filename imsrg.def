Bootstrap: docker
From: ubuntu:latest
Stage:compile

%files
  ../imsrg /imsrg

%post
  DEBIAN_FRONTEND=noninteractive
  apt-get update && apt-get install -y \
  build-essential \
  gcc\
  libomp-dev \
  libopenblas-dev \
  liblapack-dev \
  libgsl-dev \
  libhdf5-dev \
  zlib1g-dev \
  libboost-all-dev \
  cmake \
  && apt-get clean && rm -rf /var/lib/apt/lists/*

  cd imsrg
  cmake CMakeLists.txt
  make


%labels
  Author Antoine Belley

Bootstrap: docker
From: ubuntu:latest
Stage:final

%post
  DEBIAN_FRONTEND=noninteractive
  apt-get update && apt-get install -y \
  libomp-dev \
  libgomp1 \
  libopenblas-dev \
  libgsl-dev \
  python3 \
  python3-numpy \
  && apt-get clean && rm -rf /var/lib/apt/lists/*

%files from compile
  /imsrg/pyIMSRG.cpython-*-x86_64-linux-gnu.so /lib/

%environment
  export PYTHONPATH="$PYTHONPATH:/lib/"
  export PATH="$PATH:/lib"
  